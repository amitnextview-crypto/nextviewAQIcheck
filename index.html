<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nextview | Ahmedabad AQI Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Poppins',sans-serif;
}

body{
  background:#0e1116;
  color:#fff;
}

/* ===== TOP BAR ===== */
.topbar{
  padding:22px;
  background:linear-gradient(135deg,#020617,#111827);
  text-align:center;
  box-shadow:0 10px 40px rgba(0,0,0,.6);
}

.topbar h1{
  font-size:24px;
  font-weight:700;
  background:linear-gradient(90deg,#00ffff,#ff3c3c,#3b82f6,#facc15,#ec4899,#4ade80);
  background-size:400% 400%;
  background-clip: text;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  animation:gradientMove 8s infinite;
}

@keyframes gradientMove{
  0%{background-position:0%}
  50%{background-position:100%}
  100%{background-position:0%}
}

/* ===== MAIN ===== */
.container{
  max-width:1100px;
  margin:40px auto;
  padding:0 20px;
}

/* ===== AQI CARD ===== */
.aqi-card{
  position:relative;
  overflow:hidden;
  border-radius:30px;
  padding:36px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  min-height:360px;
  box-shadow:0 40px 80px rgba(0,0,0,.6);
  animation:bgPulse 5s infinite alternate, gradientShift 12s linear infinite;
  background-size:200% 200%;
}



.aqi-card{
  position:relative;
}

/* Animated Gradient Border */
.aqi-card::before{
  content:'';
  position:absolute;
  inset:-4px;
  border-radius:34px;
  background:linear-gradient(
    90deg,
    #051818,
    #871a1a,
    #275193,
    #987d11,
    #632745,
    #226a3c,
    #35adad
  );
  background-size:400% 400%;
  animation:borderMove 6s linear infinite;
  z-index:0;
}

@keyframes borderMove{
  0%{background-position:0%}
  100%{background-position:100%}
}

/* Inner content safe */
.aqi-card > *{
  position:relative;
  z-index:2;
}




@keyframes bgPulse{
  from{filter:brightness(1)}
  to{filter:brightness(1.18)}
}

@keyframes gradientShift{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* ===== CLOUD BACKGROUND (UPGRADED) ===== */
.clouds{
  position:absolute;
  inset:0;
  z-index:0;
  pointer-events:none;
}

.cloud{
  position:absolute;
  width:260px;
  height:80px;
  background:rgba(230, 222, 222, 0.14);
  border-radius:100px;
  filter:blur(2px);
  animation:moveClouds linear infinite;
}

.cloud:before,
.cloud:after{
  content:'';
  position:absolute;
  background:inherit;
  width:120px;
  height:120px;
  border-radius:50%;
  top:-60px;
}

.cloud:before{ left:30px }
.cloud:after{ left:110px }

/* Cloud layers */
.cloud1{ top:6%;  animation-duration:12s; transform:scale(1.1); }
.cloud2{ top:16%; animation-duration:14s; opacity:.25; transform:scale(1.4); }
.cloud3{ top:28%; animation-duration:16s; opacity:.2;  transform:scale(1.7); }
.cloud4{ top:40%; animation-duration:13s; opacity:.28; transform:scale(1.3); }
.cloud5{ top:52%; animation-duration:18s; opacity:.18; transform:scale(2); }
.cloud6{ top:64%; animation-duration:12s; opacity:.22; transform:scale(1.5); }
.cloud7{ top:76%; animation-duration:15s; opacity:.15; transform:scale(2.2); }
.cloud8{ top:88%; animation-duration:20s; opacity:.12; transform:scale(2.5); }

@keyframes moveClouds{
  from{ left:-80% }
  to{ left:150% }
}

/* Content above clouds */
.aqi-card > *:not(.clouds){
  position:relative;
  z-index:2;
}

/* LEFT */
.card-title{
  font-size:22px;
  font-weight:600;
}

.card-sub{
  font-size:13px;
  opacity:.75;
  margin-bottom:14px;
}

.live{
  display:inline-block;
  background:#ff3c3c;
  font-size:11px;
  padding:4px 12px;
  border-radius:20px;
  animation:blink 1s infinite;
}

@keyframes blink{
  0%,100%{opacity:1}
  50%{opacity:.4}
}

.aqi-value{
  font-size:64px;
  font-weight:700;
  margin:8px 0;
}

.status{
  display:inline-block;
  padding:6px 14px;
  border-radius:20px;
  font-size:14px;
  background:rgba(0,0,0,.3);
}

.pollutants{
  margin-top:18px;
  display:flex;
  gap:30px;
  font-size:14px;
}

/* RIGHT WEATHER */
.weather-box{
  background:rgba(0,0,0,.25);
  padding:26px;
  border-radius:22px;
  min-width:300px;
}

.weather-box h4{
  font-size:22px;
}

.weather-main{
  font-size:28px;
  font-weight:600;
  margin:10px 0;
}

.weather-grid{
  margin-top:14px;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  font-size:14px;
}

.weather-grid span{ opacity:.75 }

.footer{
  margin-top:25px;
  font-size:13px;
  opacity:.7;
}

@media(max-width:900px){
  .aqi-card{
    flex-direction:column;
    gap:25px;
    text-align:center;
  }
}
</style>
</head>

<body>

<div class="topbar">
  <img src="assets/logo.png" width="150">
  <h1>Nextview Technologies (INDIA) Pvt. Ltd.</h1>
</div>

<div class="container">

<div class="aqi-card" id="card">

  <!-- CLOUDS -->
  <div class="clouds">
    <div class="cloud cloud1"></div>
    <div class="cloud cloud2"></div>
    <div class="cloud cloud3"></div>
    <div class="cloud cloud4"></div>
    <div class="cloud cloud5"></div>
    <div class="cloud cloud6"></div>
    <div class="cloud cloud7"></div>
    <div class="cloud cloud8"></div>
  </div>

  <!-- LEFT -->
  <div>
    <div class="card-title">Ahmedabad Air Quality Index (AQI)</div>
    <div class="card-sub">Real-time PM2.5 & PM10 air pollution</div>
    <div class="live">LIVE</div>
    <div class="aqi-value" id="aqi">--</div>
    <div class="status" id="status">Loading...</div>

    <div class="pollutants">
      <div>PM2.5: <b id="pm25">--</b> µg/m³</div>
      <div>PM10: <b id="pm10">--</b> µg/m³</div>
    </div>
  </div>

  <!-- RIGHT -->
  <div class="weather-box">
    <h4>Ahmedabad</h4>
    <p>Gujarat, India</p>
    <div class="weather-main">Overcast</div>
    <div class="weather-main" id="temp">-- °C</div>

    <div class="weather-grid">
      <div><span>Humidity</span><br><b id="humidity">--%</b></div>
      <div><span>Wind</span><br><b id="wind">-- km/h</b></div>
      <div><span>UV Index</span><br><b id="uv">--</b></div>
    </div>
  </div>

</div>

<div class="footer">
Last updated: <span id="time">--</span>
</div>

</div>

<script>
const isLocal = location.hostname === "localhost" || location.protocol === "file:";

const AQI_API = isLocal
  ? "https://air-quality-api.open-meteo.com/v1/air-quality?latitude=23.0225&longitude=72.5714&hourly=pm2_5,pm10,us_aqi&timezone=auto"
  : "/api/aqi";

const WEATHER_API = isLocal
  ? "https://api.open-meteo.com/v1/forecast?latitude=23.0225&longitude=72.5714&current=temperature_2m,relative_humidity_2m,wind_speed_10m,uv_index&timezone=auto"
  : "/api/weather";

const card = document.getElementById("card");

function getJSON(url, cb){
  const xhr = new XMLHttpRequest();
  xhr.open("GET", url, true);
  xhr.onreadystatechange = function(){
    if(xhr.readyState === 4 && xhr.status === 200){
      cb(JSON.parse(xhr.responseText));
    }
  };
  xhr.send();
}

function aqiLevel(aqi){
  if(aqi <= 50)   return { t:"Good",      bg:"linear-gradient(135deg,#11998e,#38ef7d)" };
  if(aqi <= 100)  return { t:"Moderate",  bg:"linear-gradient(135deg,#f7971e,#ffd200)" };
  if(aqi <= 150)  return { t:"Poor",      bg:"linear-gradient(135deg,#ff512f,#f09819)" };
  if(aqi <= 200)  return { t:"Unhealthy", bg:"linear-gradient(135deg,#cb2d3e,#ef473a)" };
  return          { t:"Hazardous", bg:"linear-gradient(135deg,#232526,#414345)" };
}

function loadData(){
  getJSON(AQI_API, function(aqiRes){
    getJSON(WEATHER_API, function(wRes){

      const i = aqiRes.hourly.time.length - 1;
      const aqiVal = aqiRes.hourly.us_aqi[i];
      const lvl = aqiLevel(aqiVal);

      document.getElementById("aqi").innerText = aqiVal;
      document.getElementById("status").innerText = lvl.t;
      document.getElementById("pm25").innerText = aqiRes.hourly.pm2_5[i];
      document.getElementById("pm10").innerText = aqiRes.hourly.pm10[i];

      card.style.background = lvl.bg;

      document.getElementById("temp").innerText = wRes.current.temperature_2m + " °C";
      document.getElementById("humidity").innerText = wRes.current.relative_humidity_2m + " %";
      document.getElementById("wind").innerText = wRes.current.wind_speed_10m + " km/h";
      document.getElementById("uv").innerText = wRes.current.uv_index;
      document.getElementById("time").innerText = new Date().toLocaleString();

    });
  });
}

loadData();
setInterval(loadData, 15000);
</script>


</body>
</html>
